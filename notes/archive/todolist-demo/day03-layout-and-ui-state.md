# Vue Todo 项目 · Day 3: 布局层、 UI状态和数据流优化

在 **Day 2** 中，我已经基于 TodoList 示例项目，梳理了 Vue 3 中：

- 响应式数据流的单向设计
- composable（useTodos）的职责边界
- 展示组件只通过 props / emit 参与数据流

当时的核心目标是：  
**搞清楚“数据从哪里来，又是如何流动的”。**

在这个基础上，Day 3 的重点发生了转移：

> **当数据流已经清晰之后，  
> 页面结构、视图状态和组件层级应该如何合理引入？**

这一天我新增了 **Menu.vue** 和 **Layouts.vue**，项目也从“列表示例”正式演变为一个**具有布局结构的应用**。

---

## 一、Day 3 的核心变化：从“列表”到“页面结构”

在 Day 2 的阶段，项目结构大致是：

- useTodos：管理 todos 数据
- App.vue：协调数据与组件
- TodoList / TodoItem：负责 UI 展示

这一阶段的问题是：

> 页面结构仍然是“隐含”的  
> 左侧 / 右侧、菜单 / 内容的职责并没有被显式表达出来

Day 3 引入了两个关键组件：

- **Layouts.vue**：页面结构与视图控制
- **Menu.vue**：左侧菜单 UI

至此，项目的结构层次开始清晰分化。

---

## 二、整体结构与分层角色

当前项目可以拆分为以下几层：

### 1️⃣ useTodos.js —— 状态层（唯一数据源）

`useTodos` 仍然是整个项目中：

> **唯一真正拥有数据、并允许修改数据的地方**

它负责：

- todos 的完整结构
- list / record 的增删改查逻辑

所有组件对数据的修改请求，最终都会回到这里。

---

### 2️⃣ Layouts.vue —— 页面结构 + 视图控制层

`Layouts.vue` 是 Day 3 新增的核心组件。

它的职责不是“管理数据”，而是：

- 定义页面结构（左侧菜单 + 右侧内容）
- 管理 UI 视角状态，例如：
    - 当前选中的 `currentId`
    - 菜单是否展开

一个重要的认知转变是：

> **切换当前 List，并不会改变 todos 数据本身，  
> 只是改变“用户当前在看哪一部分内容”。**

因此，`currentId` 被放在 Layouts 中，而不是 useTodos 中。

---

### 3️⃣ Menu.vue —— 左侧菜单 UI

`Menu.vue` 是一个非常典型的“纯展示组件”：

- 接收 `todos` 和 `currentId`
- 根据状态进行高亮展示
- 用户交互时，仅通过 `emit` 抛出意图

它不做的事情同样重要：

- 不引入 useTodos
- 不直接修改任何状态
- 不关心数据如何存储或更新

Menu 的定位可以总结为一句话：

> **只负责“展示列表”和“告诉外部用户点了什么”。**

---

### 4️⃣ TodoList.vue / TodoItem.vue —— 内容区 UI

右侧内容区域仍然由：

- TodoList：列表级 UI
- TodoItem：最小粒度 UI

它们继续遵循 Day 2 中确立的原则：

- 数据来自 props
- 行为通过 emit 向上传递
- 不直接修改业务数据

---

### 5️⃣ App.vue —— 协调层

在 Day 3 中，App.vue 的角色进一步明确为：

> **连接状态层、布局层和展示层的“中枢”**

它负责：

- 从 useTodos 获取数据和操作方法
- 将数据传入 Layouts 和 TodoList
- 将组件抛出的事件转交给 useTodos 执行

---

## 三、前端中的两种状态：在 Day 3 中被真正区分

Day 3 最重要的收获之一，是对“状态类型”的进一步区分。

---

### 1️⃣ 业务数据状态（Domain / Data State）

这类状态描述的是：

- 数据本身是什么
- 业务逻辑如何运转

在本项目中包括：

- todos
- list
- record
- checked、text 等字段

它们集中存在于 **useTodos.js** 中。

---

### 2️⃣ 界面视角状态（UI / View State）

这类状态描述的是：

- 用户当前在“看什么”
- 页面如何展示

例如：

- currentId（当前选中的列表）
- 菜单是否展开
- 某些只读 / 禁用状态

这些状态：

- 不改变业务数据
- 强依赖页面结构
- 生命周期与布局组件绑定

因此被放在 **Layouts.vue 或具体 UI 组件中**。

---

## 四、阶段性总结

从 Day 2 到 Day 3，我的关注点发生了明显变化：

- Day 2：**数据如何流动**
- Day 3：**数据流之上，结构和视角如何组织**

目前项目的整体设计可以总结为：

> useTodos 管理业务数据  
> Layouts 管理页面结构与视图状态  
> Menu / TodoList / TodoItem 负责 UI 展示  
> App.vue 负责把所有层级连接起来

这一步，标志着我开始从“能写 Vue 组件”，  
走向“理解一个 Vue 应用是如何被分层设计的”。
